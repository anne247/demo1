Started by user Anne Marie
Replayed #7
Loading library jenkins-library@main
Attempting to resolve main from remote references...
 > git --version # timeout=10
 > git --version # 'git version 2.37.2'
using GIT_ASKPASS to set credentials ibt
 > git ls-remote -h -- https://github.com/IBT-learning/jenkins-library.git # timeout=10
Found match: refs/heads/main revision c46a1165e82e3d3468982ee4724216aac7f98b66
Selected Git installation does not exist. Using Default
The recommended git tool is: NONE
using credential ibt
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/Advanced-Oct21st-Cohort/AnneM-Workspace/netflix-ecr@libs/6bae119d76cdbcf6b68591314c633ed04d2648aa8ce75046bd8c29f3534ba6b9/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/IBT-learning/jenkins-library.git # timeout=10
Fetching without tags
Fetching upstream changes from https://github.com/IBT-learning/jenkins-library.git
 > git --version # timeout=10
 > git --version # 'git version 2.37.2'
using GIT_ASKPASS to set credentials ibt
 > git fetch --no-tags --force --progress -- https://github.com/IBT-learning/jenkins-library.git +refs/heads/*:refs/remotes/origin/* # timeout=10
Checking out Revision c46a1165e82e3d3468982ee4724216aac7f98b66 (main)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f c46a1165e82e3d3468982ee4724216aac7f98b66 # timeout=10
Commit message: "Update sonarScan.groovy"
 > git rev-list --no-walk c46a1165e82e3d3468982ee4724216aac7f98b66 # timeout=10
[Pipeline] Start of Pipeline
[Pipeline] node
Running on Jenkins in /var/lib/jenkins/workspace/Advanced-Oct21st-Cohort/AnneM-Workspace/netflix-ecr
[Pipeline] {
[Pipeline] stage
[Pipeline] { (Declarative: Checkout SCM)
[Pipeline] checkout
The recommended git tool is: NONE
No credentials specified
 > git rev-parse --resolve-git-dir /var/lib/jenkins/workspace/Advanced-Oct21st-Cohort/AnneM-Workspace/netflix-ecr/.git # timeout=10
Fetching changes from the remote Git repository
 > git config remote.origin.url https://github.com/Amgbillion/netflix-react-clone.git # timeout=10
Fetching upstream changes from https://github.com/Amgbillion/netflix-react-clone.git
 > git --version # timeout=10
 > git --version # 'git version 2.37.2'
 > git fetch --tags --force --progress -- https://github.com/Amgbillion/netflix-react-clone.git +refs/heads/*:refs/remotes/origin/* # timeout=10
 > git rev-parse refs/remotes/origin/main^{commit} # timeout=10
Checking out Revision 53631fb6409246434850e200ecd1c9d11a9b34cc (refs/remotes/origin/main)
 > git config core.sparsecheckout # timeout=10
 > git checkout -f 53631fb6409246434850e200ecd1c9d11a9b34cc # timeout=10
Commit message: "Update Jenkinsfile"
 > git rev-list --no-walk 53631fb6409246434850e200ecd1c9d11a9b34cc # timeout=10
[Pipeline] }
[Pipeline] // stage
[Pipeline] withEnv
[Pipeline] {
[Pipeline] timeout
Timeout set to expire in 20 min
[Pipeline] {
[Pipeline] stage
[Pipeline] { (pull npm dependencies)
[Pipeline] sh
+ npm install

up to date, audited 2153 packages in 8s

301 packages are looking for funding
  run `npm fund` for details

29 vulnerabilities (12 moderate, 15 high, 2 critical)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (build Docker Image)
[Pipeline] script
[Pipeline] {
[Pipeline] isUnix
[Pipeline] withEnv
[Pipeline] {
[Pipeline] sh
+ docker build -t 012010923904.dkr.ecr.us-east-1.amazonaws.com/netflix-oct:v1 .
#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 775B done
#1 DONE 0.0s

#2 [internal] load .dockerignore
#2 transferring context: 2B done
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/node:19.9.0-alpine3.18
#3 DONE 0.1s

#4 [internal] load metadata for docker.io/library/nginx:bullseye
#4 DONE 0.4s

#5 [builder 1/4] FROM docker.io/library/node:19.9.0-alpine3.18@sha256:8ec543d4795e2e85af924a24f8acb039792ae9fe8a42ad5b4bf4c277ab34b62e
#5 DONE 0.0s

#6 [stage-1 1/4] FROM docker.io/library/nginx:bullseye@sha256:b997b0db9c2bc0a2fb803ced5fb9ff3a757e54903a28ada3e50412cc3ab7822f
#6 DONE 0.0s

#7 [internal] load build context
#7 transferring context: 10.38MB 4.1s done
#7 DONE 4.3s

#8 [builder 2/4] WORKDIR /app
#8 CACHED

#9 [builder 3/4] COPY . .
#9 DONE 29.4s

#10 [builder 4/4] RUN yarn install && yarn run build
#10 0.866 yarn install v1.22.19
#10 1.107 warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
#10 1.115 [1/4] Resolving packages...
#10 2.864 [2/4] Fetching packages...
#10 38.19 warning np@7.7.0: The engine "git" appears to be invalid.
#10 38.24 [3/4] Linking dependencies...
#10 38.24 warning " > @testing-library/user-event@12.8.3" has unmet peer dependency "@testing-library/dom@>=7.21.4".
#10 38.25 warning "movie-trailer > xo > eslint-import-resolver-webpack@0.13.2" has unmet peer dependency "webpack@>=1.11.0".
#10 38.25 warning "react-scripts > eslint-config-react-app > eslint-plugin-flowtype@8.0.3" has unmet peer dependency "@babel/plugin-syntax-flow@^7.14.5".
#10 38.25 warning "react-scripts > eslint-config-react-app > eslint-plugin-flowtype@8.0.3" has unmet peer dependency "@babel/plugin-transform-react-jsx@^7.14.9".
#10 38.26 warning "react-scripts > react-dev-utils > fork-ts-checker-webpack-plugin@6.5.3" has unmet peer dependency "typescript@>= 2.7".
#10 63.62 [4/4] Building fresh packages...
#10 65.22 success Saved lockfile.
#10 65.23 Done in 64.37s.
#10 65.72 yarn run v1.22.19
#10 65.81 $ react-scripts build
#10 69.35 Creating an optimized production build...
#10 108.3 Compiled with warnings.
#10 108.3 
#10 108.3 Failed to parse source map from '/app/node_modules/@firebase/auth/dist/ [synthetic:es6/promise/promise] ' file: Error: ENOENT: no such file or directory, open '/app/node_modules/@firebase/auth/dist/ [synthetic:es6/promise/promise] '
#10 108.3 
#10 108.3 Failed to parse source map from '/app/node_modules/@firebase/auth/dist/ [synthetic:es6/util/arrayiterator] ' file: Error: ENOENT: no such file or directory, open '/app/node_modules/@firebase/auth/dist/ [synthetic:es6/util/arrayiterator] '
#10 108.3 
#10 108.3 Failed to parse source map from '/app/node_modules/@firebase/auth/dist/ [synthetic:es6/util/makeiterator] ' file: Error: ENOENT: no such file or directory, open '/app/node_modules/@firebase/auth/dist/ [synthetic:es6/util/makeiterator] '
#10 108.3 
#10 108.3 Failed to parse source map from '/app/node_modules/@firebase/auth/dist/ [synthetic:util/defineproperty] ' file: Error: ENOENT: no such file or directory, open '/app/node_modules/@firebase/auth/dist/ [synthetic:util/defineproperty] '
#10 108.3 
#10 108.3 Failed to parse source map from '/app/node_modules/@firebase/auth/dist/ [synthetic:util/global] ' file: Error: ENOENT: no such file or directory, open '/app/node_modules/@firebase/auth/dist/ [synthetic:util/global] '
#10 108.3 
#10 108.3 Failed to parse source map from '/app/node_modules/@firebase/auth/dist/ [synthetic:util/polyfill] ' file: Error: ENOENT: no such file or directory, open '/app/node_modules/@firebase/auth/dist/ [synthetic:util/polyfill] '
#10 108.3 
#10 108.3 Search for the keywords to learn more about each warning.
#10 108.3 To ignore, add // eslint-disable-next-line to the line before.
#10 108.3 
#10 108.3 File sizes after gzip:
#10 108.3 
#10 108.4   349.7 kB  build/static/js/main.9c0b54c1.js
#10 108.4 
#10 108.4 The project was built assuming it is hosted at /.
#10 108.4 You can control this with the homepage field in your package.json.
#10 108.4 
#10 108.4 The build folder is ready to be deployed.
#10 108.4 You may serve it with a static server:
#10 108.4 
#10 108.4   yarn global add serve
#10 108.4   serve -s build
#10 108.4 
#10 108.4 Find out more about deployment here:
#10 108.4 
#10 108.4   https://cra.link/deployment
#10 108.4 
#10 108.5 Done in 42.77s.
#10 DONE 108.7s

#11 [stage-1 2/4] WORKDIR /usr/share/nginx/html
#11 CACHED

#12 [stage-1 3/4] RUN rm -rf ./*
#12 CACHED

#13 [stage-1 4/4] COPY --from=builder /app/build .
#13 CACHED

#14 exporting to image
#14 exporting layers done
#14 writing image sha256:0ae1feacef87fb3914065943b2a377ace37b69180288b120a43a5433d13011d5 done
#14 naming to 012010923904.dkr.ecr.us-east-1.amazonaws.com/netflix-oct:v1 done
#14 DONE 0.0s
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Trivy Scan (Aqua))
[Pipeline] sh
+ trivy image --format template --output trivy_report.html 012010923904.dkr.ecr.us-east-1.amazonaws.com/netflix-oct:v1
2023-10-30T03:46:19.357Z	[33mWARN[0m	'--format template' is ignored because '--template' is not specified. Specify '--template' option when you use '--format template'.
2023-10-30T03:46:19.370Z	[34mINFO[0m	Vulnerability scanning is enabled
2023-10-30T03:46:19.370Z	[34mINFO[0m	Secret scanning is enabled
2023-10-30T03:46:19.370Z	[34mINFO[0m	If your scanning is slow, please try '--scanners vuln' to disable secret scanning
2023-10-30T03:46:19.370Z	[34mINFO[0m	Please see also https://aquasecurity.github.io/trivy/v0.41/docs/secret/scanning/#recommendation for faster secret detection
2023-10-30T03:46:19.409Z	[34mINFO[0m	Detected OS: debian
2023-10-30T03:46:19.409Z	[34mINFO[0m	Detecting Debian vulnerabilities...
2023-10-30T03:46:19.463Z	[34mINFO[0m	Number of language-specific files: 0
[Pipeline] }
[Pipeline] // stage
[Pipeline] stage
[Pipeline] { (Push to ECR)
[Pipeline] script
[Pipeline] {
[Pipeline] withEnv
[Pipeline] {
[Pipeline] withDockerRegistry
[Pipeline] // withDockerRegistry
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // script
[Pipeline] }
[Pipeline] // stage
[Pipeline] }
[Pipeline] // timeout
[Pipeline] }
[Pipeline] // withEnv
[Pipeline] }
[Pipeline] // node
[Pipeline] End of Pipeline
ERROR: Could not find credentials matching ecr:eu-east-1:anne-ecr
/var/lib/jenkins/jobs/Advanced-Oct21st-Cohort/jobs/AnneM-Workspace/workspace/netflix-ecr@tmp/jfrog/8/.jfrog deleted
Finished: FAILURE